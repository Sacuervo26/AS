<nav class="w-full navbar px-4 md:px-8 flex flex-row justify-evenly fixed top-0 z-50 bg-[#F6B09C] shadow-black/20 shadow-md gap-x-20 lg:gap-x-20 text-black" aria-label="Navegación principal">
    <!-- Logo con enlace a inicio -->
    <div class="navbar-start w-auto">
        <a href="/" aria-label="Ir a página de inicio">
            <div class="w-16 h-16 lg:w-20 lg:h-20 overflow-visible">
                <img 
                    src="/LogoNegro.webp" 
                    alt="Logo de la empresa - Maquillaje profesional" 
                    width="80" 
                    height="80"
                    class="w-full h-full object-contain scale-150 lg:scale-250 origin-center"
                    loading="lazy">
            </div>
        </a>
    </div>
    
    <!-- Menú desktop -->
    <div class="navbar-center hidden lg:flex">
        <ul class="menu menu-horizontal gap-1 lg:gap-2 whitespace-nowrap text-md">
            <li><a href="/" class="hover:bg-[#FFB4A2] hover:shadow-sm hover:text-white hover:font-semibold rounded-lg px-3 py-2 text-lg lg:text-xl" aria-current="page">Inicio</a></li>
            
            <li>
                <details class="relative">
                    <summary class="hover:bg-[#FFB4A2] hover:shadow-sm hover:text-white hover:font-semibold rounded-lg px-3 py-2 text-lg lg:text-xl" aria-haspopup="true" aria-expanded="false">Maquillajes</summary>
                    <ul class="absolute left-0 p-2 rounded-lg whitespace-nowrap min-w-max shadow-black/60 shadow-lg bg-white text-sm" role="menu">
                        <li><a href="/MSocial" class="hover:bg-[#FFB4A2] px-4 py-2 w-full text-left" role="menuitem">Maquillaje Social</a></li>
                        <li><a href="/MQuince" class="hover:bg-[#FFB4A2] px-4 py-2 w-full text-left" role="menuitem">Maquillaje para Quinceañeras</a></li>
                        <li><a href="/MNovias" class="hover:bg-[#FFB4A2] px-4 py-2 w-full text-left" role="menuitem">Maquillaje para Novias</a></li>
                    </ul>
                </details>
            </li>
            
            <li><a href="/HPeinados" class="hover:bg-[#FFB4A2] hover:shadow-sm hover:text-white hover:font-semibold rounded-lg px-3 py-2 text-lg lg:text-xl">Peinados</a></li>
            <li><a href="/HEscuela" class="hover:bg-[#FFB4A2] hover:shadow-sm hover:text-white hover:font-semibold rounded-lg px-3 py-2 text-lg lg:text-xl">Escuela de Alma</a></li>
            <li><a href="/HNosotros" class="hover:bg-[#FFB4A2] hover:shadow-sm hover:text-white hover:font-semibold rounded-lg px-3 py-2 text-lg lg:text-xl">Sobre Nosotros</a></li>
            <li><a href="#contacto" class="hover:bg-[#FFB4A2] hover:shadow-sm hover:text-white hover:font-semibold rounded-lg px-3 py-2 text-lg lg:text-xl">Contacto</a></li>
        </ul>
    </div>
    
    <!-- Menú móvil corregido para Safari -->
    <div class="navbar-end lg:hidden">
        <div class="dropdown dropdown-end">
            <button id="mobile-menu-btn" role="button" class="btn btn-ghost px-2" aria-label="Menú móvil" aria-expanded="false" aria-controls="mobile-menu">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
            <ul id="mobile-menu" class="menu menu-sm dropdown-content hidden bg-white rounded-box z-50 mt-3 w-52 p-2 shadow border border-[#E5989B]" role="menu">
                <li><a href="/" class="hover:bg-[#FFB4A2] px-4 py-2 text-black" role="menuitem" aria-current="page">Inicio</a></li>
                <li>
                    <details>
                        <summary class="hover:bg-[#FFB4A2] px-4 py-2 text-black" aria-haspopup="true" aria-expanded="false">Maquillajes</summary>
                        <ul class="p-2 bg-white" role="menu">
                            <li><a href="/MSocial" class="hover:bg-[#FFB4A2] px-4 py-2 text-black" role="menuitem">Maquillaje Social</a></li>
                            <li><a href="/MQuince" class="hover:bg-[#FFB4A2] px-4 py-2 text-black" role="menuitem">Maquillaje para Quinceañeras</a></li>
                            <li><a href="/MNovias" class="hover:bg-[#FFB4A2] px-4 py-2 text-black" role="menuitem">Maquillaje para Novias</a></li>
                        </ul>
                    </details>
                </li>
                <li><a href="/HPeinados" class="hover:bg-[#FFB4A2] px-4 py-2 text-black" role="menuitem">Peinados</a></li>
                <li><a href="/HEscuela" class="hover:bg-[#FFB4A2] px-4 py-2 text-black" role="menuitem">Escuela de Alma</a></li>
                <li><a href="/HNosotros" class="hover:bg-[#FFB4A2] px-4 py-2 text-black" role="menuitem">Sobre Nosotros</a></li>
                <li><a href="#contacto" class="hover:bg-[#FFB4A2] px-4 py-2 text-black" role="menuitem">Contacto</a></li>
            </ul>
        </div>
    </div>
</nav>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Selección segura de elementos con type assertion
        const mobileMenuBtn = document.getElementById('mobile-menu-btn') as HTMLButtonElement | null;
        const mobileMenu = document.getElementById('mobile-menu') as HTMLElement | null;
        
        // Verificación exhaustiva de elementos
        if (!mobileMenuBtn || !mobileMenu) {
            console.error('Elementos del menú no encontrados');
            return;
        }
    
        // Función para alternar el menú con manejo de tipos seguro
        const toggleMenu = (): void => {
            const currentState = mobileMenuBtn.getAttribute('aria-expanded');
            const isExpanded = currentState === 'true';
            
            // Corrección: Convertir boolean a string explícitamente
            mobileMenuBtn.setAttribute('aria-expanded', String(!isExpanded));
            
            // Alternar visibilidad usando style.display para máxima compatibilidad con Safari
            mobileMenu.style.display = isExpanded ? 'none' : 'block';
        };
    
        // Manejador de eventos con type assertion para el target
        const handleButtonClick = (e: MouseEvent): void => {
            e.preventDefault();
            e.stopPropagation();
            toggleMenu();
        };
    
        // Manejador para clicks fuera del menú
        const handleDocumentClick = (e: MouseEvent): void => {
            // Type assertion seguro para el target
            const target = e.target as Node | null;
            if (!target) return;
            
            if (!mobileMenu.contains(target) && !mobileMenuBtn.contains(target)) {
                mobileMenuBtn.setAttribute('aria-expanded', 'false');
                mobileMenu.style.display = 'none';
            }
        };
    
        // Manejador para clicks en enlaces del menú
        const handleLinkClick = (): void => {
            mobileMenuBtn.setAttribute('aria-expanded', 'false');
            mobileMenu.style.display = 'none';
        };
    
        // Asignación de eventos
        mobileMenuBtn.addEventListener('click', handleButtonClick);
        document.addEventListener('click', handleDocumentClick);
        
        // Asignación a los enlaces del menú
        const menuLinks = mobileMenu.querySelectorAll('a');
        menuLinks.forEach(link => {
            link.addEventListener('click', handleLinkClick);
        });
    
        // Inicialización del estado
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
        mobileMenu.style.display = 'none';
    });
    </script>